# SMB (445)
In computer networking, Server Message Block (SMB),operates as an application-layer or presentation-layer network protocol mainly used for providing shared access to files, printers, and serial ports and miscellaneous communications between nodes on a network. It also provides an authenticated inter-process communication mechanism. Most usage of SMB involves computers running Microsoft Windows, where it was known as "Microsoft Windows Network" before the introduction of Active Directory. Corresponding Windows services are LAN Manager Server (for the server component) and LAN Manager Workstation (for the client component)

## On Linux

### Enum4linux
Enum4linux is a tool for enumerating information from Windows and Samba systems. It attempts to offer similar functionality to enum.exe formerly available from www.bindview.com.  
```bash
enum4linux -a -u administrator #IP-ADRESS#
```
### SMB NMAP Scripts
Find SMB vulnerabilities
```bash
nmap --script=smb-vuln* -p 137,139,445 192.168.1.1
```
Enum SMB Shares
```bash
nmap -p 139,445 --script smb-enum-shares.nse 192.168.1.1
```

### smbmap
SMBMap allows users to enumerate samba share drives across an entire domain. List share drives, drive permissions, share contents, upload/download functionality, file name auto-download pattern matching, and even execute remote commands.   
```bash
smbmap -H #IP-ADRESS#
smbmap -H #IP-ADRESS# -d WORKGROUP -u admin -password
```
 
### smbclient
smbclient is a client that can 'talk' to an SMB/CIFS server. It offers an interface similar to that of the ftp program (see ftp(1)). Operations include things like getting files from the server to the local machine, putting files from the local machine to the server, retrieving directory information from the server and so on.   
```bash
smbclient -L #IP-ADRESS#
smbclient -L #IP-ADRESS# -W=WORKGROUP -U=admin -p=445
```

### smbget
smbget downloads files from a samba share specified.
```bash
smbget -U=User-R  smb://192.168.1.1/Mypath$/subdir/oerlex/
```
### nmap script smb-enum-shares
Attempts to list shares using the srvsvc.NetShareEnumAll MSRPC function and retrieve more information about them using srvsvc.NetShareGetInfo. If access to those functions is denied, a list of common share names are checked.  
```bash
nmap -script smb-enum-shares -p445 #IP-ADRESS#
nmap -script vuln -p445 #IP-ADRESS#
```
## On Windows
Find shares with
```bash
net view \\192.168.1.2\ /All
net share
```
# Netbios (137)
NetBIOS over TCP/IP (NBT, or sometimes NetBT) is a networking protocol that allows legacy computer applications relying on the NetBIOS API to be used on modern TCP/IP networks.

## nmblookup
nmblookup is used to query NetBIOS names and map them to IP addresses in a network using NetBIOS over TCP/IP queries. The options allow the name queries to be directed at a particular IP broadcast area or to a particular machine. All queries are done over UDP.  
```bash 
nmblookup -A #IP-ADRESS#
```

## nbtscan  
This is a command-line tool that scans for open NETBIOS nameservers on a local or remote TCP/IP network, and this is a first step in finding of open shares. It is based on the functionality of the standard Windows tool nbtstat, but it operates on a range of addresses instead of just one.  

```bash
nbtscan #IP-ADRESS#
```

# RPC (135)

## MSRPC Enumeration
```bash
nmap -p 137,139,445 --script=msrpc-enum 192.168.1.1
```

## RPCClient
rpcclient is a utility initially developed to test MS-RPC functionality in Samba itself. It has undergone several stages of development and stability. Many system administrators have now written scripts around it to manage Windows NT clients from their UNIX workstation.  
```bash
rpcclient -U "" -N #IP-ADRESS#
rpcclient -U "admin" -N #IP-ADRESS#
```
