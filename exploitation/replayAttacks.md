## Capture Network Traffic
Capture traffic of interest in Wireshark or tcpdump. This is usually unidrectional, easier, from point A to B.  
Example: 192.168.1.1 -> 192.168.2.100

Filter the traffic by ip.dst=192.168.2.100 && tcp and export it as pcap file.

## TCP Rewrite
We want to change the source address so that point B answeres to our spoofed IP address. Let's say our IP is 192.168.3.123 and our MAC is AB:CD:EF:12:34:56.
```console
tcprewrite --infile=test1.pcap --outfile=test2.pcap --srcipmap=0.0.0.0/0:192.168.1.123 --enet-smac=AB:CD:EF:12:34:56 
```
Next we need to correct the checksum of every packet
```console
tcprewrite --infile=test2.pcap --outfile=test3.pcap --fixcsum 
```

## TCP Replay
Replay the modified pcap file and monitor the response in Wireshark
```console
sudo tcpreplay --intf1=eth0 test3.pcap 
```
To loop add 100
```console
sudo tcpreplay --loop=100 --intf1=eth0 test3.pcap 
```

## Sources

tcpreplay manual - https://tcpreplay.appneta.com/wiki/tcpreplay-man.html
tcprewrite manual - https://tcpreplay.appneta.com/wiki/tcprewrite-man.html
http://xmodulo.com/how-to-capture-and-replay-network-traffic-on-linux.html
